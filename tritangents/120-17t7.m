r<x> := PolynomialRing(Rationals());

g := 
878411037972587750510256359897755134720088270301599225214729216985636771005048339118930383*x^120 + 64524070706581439602725101446430547072339863098629526890879366881420285674388442064916761624*x^119 + 
    2050113147791662855713155228300210208108517143708092798827169640122600518828151888796583669260*x^118 + 32845674317356402890943965826885603760561697955612681058101087681888484734737380873477364480648*x^117 + 
    122694960182686071244923678797473764310582253046001812753121032067315708950037414459336474066846*x^116 - 6376623815655172081009065886972628031777111064630083720301005985368145946395091377023894032285144*x^115 - 
    160454536285801769499474667216778198273379669270886698504342222651432398685868719139677757233343060*x^114 - 1886741179882890196342902954927245664311457590083275041025856252683467004130078789262731104707038280*x^113 - 
    8453703879069125401491449702017085683950152031193227204971397742287828880269061778930992412417510959*x^112 + 114701358887777045320367901740695946417607194627477268633469294646087841364888993849473365488871607888*x^111 + 
    2899981723255096130465290937922102942785025021074936462573468321377366189360439356106381249193234389768*x^110 + 
    33849370942738526535023790250457864019607659371279367953392969803785334958498509493522739575638731565616*x^109 + 
    249035259124724287962559501953345541511787834868718320525228098265087757110584607337199698914705228144244*x^108 + 
    919285738905844092453804829462764748836932775142282274894635708945957794154692465278235918927271891666192*x^107 - 
    4719527664549000917685602106017302799118967211379754318706041283992162253074411773649383333816592941210312*x^106 - 
    121601041637060444672092692784051547487007049453835184591919587569652092208349246136987432336213381019059856*x^105 - 
    1324143839191129820720894058763643610308302929825156535339008686221549971156636092194441157808291153548802943*x^104 - 
    10622799321248114775272097697106120715442066772995175579509701194797343230183400140758927923278846032345820232*x^103 - 
    70143301428754459341994678061462677835481334253068000413440823013518852465149311245974181884459993796168905284*x^102 - 
    398733276189520578828802876867070324455201510356087972983601074352266879936361376450648729949879478606892292888*x^101 - 
    1998902916082052656554716654985979364514126480703899389270657102547783162020323144540729321948663106739007781058*x^100 - 
    8972170710588988376268015905336327507896297427704650924198676413623442625038589911432217431701419277752683891704*x^99 - 
    36441093962122480836690328004490439847892108253924110455572100133533575606013935036230283266657615521694085497060*x^98 - 
    134993181993837952801913473536523023947688263130425439606677078715306170553503685322281123100854125355420189177384*x^97 - 
    458955217033975081173158477906902898268034705526518089816789198067448475794013777564622242572833821600156730125345*x^96 - 
    1439426629611049529457390737988871394407310367903980435853956764258613117803324750786465857723778618821411020266912*x^95 - 
    4182605700434335597608120523419558227386616114728477887492791265573345769159079240694491463169164645332248761537488*x^94 - 
    11302288909783959630927809718742574307718181840797140180819083509376505334613327070322595900427664442610692418360608*x^93 - 
    28495740860370830900141698787670174715070132099376222891118338991515241022125355036203194181124008153357323617176432*x^92 - 
    67231159020857544200740897461054063843694837627279207134029111439822122051125508062549259247996542372990502057845440*x^91 - 
    148834434486097719488691583417091242822999727961282853249179992318017333251473460721394554420116536730215819250827520*x^90 - 
    309919221693261971880422032039833743096627243358860646351454587187745998051922135960035112448884342194110833455655296*x^89 - 
    608412767701592096623705591946728073192253737869310594413932248293930363076411100221730126806679721077400359362747872*x^88 - 
    1128446415057743273804625761683147615905626286170102519724778799332999372098764986349757175709535848656352428871154944*x^87 - 
    1981391947718178684267315510570578175277593703379471460418824150243175598457324074349239370396582129050841335158536192*x^86 - 
    3299852513641551017952851656722656713489403198286372591356006954196983665951553797360939997260626356288867947414372864*x^85 - 
    5222050869120503479569634394149309413175253722938356755596246770811907050061557445490354648344724435757442916677696256*x^84 - 
    7866151026726328489212897175305308723541587918577638240999721733737645190284001707259449963691894758645213560944057344*x^83 - 
    11297385532663705109430881705448602699168448481868202956184092658065046640512207788806234732136867550215972855591193600*x^82 - 
    15494509708692952988611651953770529627946548025754927213077946258539074824309459168424523254840816685905869003029381120*x^81 - 
    20324634977765369033217813357099348076973614578416875793557083135552226468032300151287921308298040989686803306355207424*x^80 - 
    25535534411191626086419717005331192533089499802933590428560789421659436959255838742910079287093464014477130231409790976*x^79 - 
    30771434202909131703695878095343416498947583415122541905657984144184669471432724293069842564215280264309715496479371264*x^78 - 
    35612659981409366245101925695287339103295647819204644889877695765258461176176201060704621571669230515546093845923053568*x^77 - 
    39632967821368832203402800352878506845288224134976537526266872675801660564255664835508538891501358097052650873884319744*x^76 - 
    42463136807848835283466511078498934398539680017817242573774677601145471601477015493997657676060325021806632459246895104*x^75 - 
    43847246572650094414859109205637794183759172628810842348595991183184712163766279461736536649843551214790587233331249152*x^74 - 
    43679727567955398012695080093312675568799848915094321612157945214638886081620452820292898528964829393662870590813503488*x^73 - 
    42016131392813268026728245525207406034349686395600803077920658393390798837924927966884972876238953401153284116631355392*x^72 - 
    39056978676357252720340777645555884898886254876068394288181030721002212058779548528897885398225334865479452617043345408*x^71 - 
    35110025887292444580751422569856631390914265075951003693632013893786025997887406841550188429463963191642242232040816640*x^70 - 
    30540262777018486403385429698750234823114121016924488606461209756523077979098514476319426150414230807905611113947463680*x^69 - 
    25718169184194933002692808934607108851699332304463512532831620451527139275140322339352276463560366269358464734086037504*x^68 - 
    20975399949709178412181096235494940258240044438246033499527652336326012262648994999635617728592704786141695159832674304*x^67 - 
    16573967467094267269968146460881707539381962258059109122546413912860900743490930999671444988418403783911027982153023488*x^66 - 
    12691251041977316894641754011766145793707323247684475464822411184793158317878042154574657482166540657529399232072515584*x^65 - 
    9419771363424659475560047952681930836598873490805097675837256834876706500861686558767643621367072429132283134778408960*x^64 - 
    6778282850739923175621755964081250576559625532057694625230053493912169757853538916762342560339876503138031221627420672*x^63 - 
    4729610732396343134325491700208033932728777188937294401062784796370166521998390741094774003214144089550305137845600256*x^62 - 
    3200700919263073720209805522366590796651932194345779648173405792188453267872876059273159831570006101950831350645784576*x^61 - 
    2101238518432978953533978984419025767784613667097618521190656941178593769328959019274051281024453998001051619834200064*x^60 - 
    1338510562805973948444726295578627633927518471754972213484366327400194835536812819525976538851405046002841554463490048*x^59 - 
    827548077231043385223376719838007455475544511452601977296293523995489266300175552794507018182422349227540245764898816*x^58 - 
    496693138826474574586754023767230139783765639957991783861477126855442226552999770705251987997253908257682411548049408*x^57 - 
    289449431558019322527274147785320533363896087096877970877088478059768372548953508722621824106650061409751402096361472*x^56 - 
    163775727158007374937474829534509361253180375072445249183670191676129126551713592673508591993721637039832214578135040*x^55 - 
    89953690462022726103229110835242808356938078617695996561946359351005627795502347976822865107466617986717435249557504*x^54 - 
    47933001326241070679962887212287852278869778656496010081189841257285358066969105653245234186576885834990861011648512*x^53 - 
    24754656857028868409949690692358942165300627015083638014222375295541568748230286501605849228940690832758620372860928*x^52 - 
    12371100941097839599575496829278131752926208575615442615654766473776960171080220535069223268026171134533385949544448*x^51 - 
    5969422110192522678028120720306756021979267245470924822029595130680908541709410542260084626979243246679853283409920*x^50 - 
    2773030371027928565631513352742798659714398718291149778645359177346596750709794797504980578168842900579433169551360*x^49 - 
    1235503061178650967570981199352374693068061068087469836369040485362191738574080931421905304312539820199973335597056*x^48 - 
    525485580232973787827375786439839409165259491957821098138610899036561346554408542993630262939770464833718424961024*x^47 - 
    212123093954833832141714801544247092660011895106403741851732797957813803633782094805825525007598790758064755572736*x^46 - 
    80691924796943554107744376888986519436339800762741034316329772083256614382302210474934001296291070855302757744640*x^45 - 
    28675015804012042585857193909794135337255372292608076932528961266495719872861019741277986710074393369804579799040*x^44 - 
    9421756327417245836935886100748983727443044843539712555932615441212796847150588168239452130438270932475657060352*x^43 - 
    2832476496910752068784767518039602742031153549394499556104653723275007035793060410066409740608154377240996478976*x^42 - 
    776860406130406523000811905507388680657269637142994267631761735714228675686747236640506209840985010483033538560*x^41 - 
    201443512626174132486732311836969423687181427539997626931627416780653219783500678959831256665163768558289682432*x^40 - 
    57539944782842941738179494995079888061138588515665554071646012095784838746872318087377122080408104816716283904*x^39 - 
    23007469126395938157841429317551451713670497258398701784103603119160118020772980132289262346802511763946340352*x^38 - 
    12328519593686264945708269370047783756317682205956750608474058236395920867847879288930475024659141022814568448*x^37 - 
    6913263112984424577538054212111262661108460818667524942990672918910266338070384691248474754908235734232072192*x^36 - 
    3589578644105448256322646079965434463347351614169213619687999724735652942203061854959232572249178956917374976*x^35 - 
    1683901254692860584093150976726179921746800170787083469939499150793765122236767449468933224474886984161034240*x^34 - 
    716448260473671078865140772787337584052920694206304057589598283678473032629534042124194816896458786145828864*x^33 - 
    278967429436606564605158573065034911692775915833582557200040376927494962476312018752986660408317106588745728*x^32 - 
    100279193721598935681047598669493610269699276403510215933825612135326850850139924220640450284252165750915072*x^31 - 
    33535595953479687112771710603671419901737257344911112905553214556124493203061743317218672542652299030298624*x^30 - 
    10506818883074749198429683454511259482721894711105323458230158460867958423095993265596433167208816022913024*x^29 - 
    3104448013014035189738029741464264045726959092353894239928355929041776458191733209782060417990169670451200*x^28 - 
    870673741285044573622558005265526864347044836699134870123919226824341681426037444776889557927846496698368*x^27 - 
    233231335302947027713224915129723457984934350622249911134082631502730160548035439853998292965074380259328*x^26 - 
    60005482943045450908516341678202597091990015389304819801943163123583079772410968247005809177407371870208*x^25 - 
    14890066056635279812736618421890338207736622525749534850769433856305620835518678038039982747022799142912*x^24 - 
    3571471908825475715611339948768397090071412194287912529108845517069139683239582511347766159722621698048*x^23 - 827798209684905556278650153742604368914342313531366496195091575343222948736039345407972385373217095680*x^22 - 
    184923717898469909813777791924786508101148768943176755533817334508425765341067168018155199187476545536*x^21 - 39641036257857946480885144637448616951987524788818164093485551726954951685427083566989703369969369088*x^20 - 
    8110362205971259421195508660431623756394325845600683175442500914669749302128351648178388797812113408*x^19 - 1574711376812853729187802963419681931086473740310736561874089671829084759244978063075887317644214272*x^18 - 
    288537445380281868567439481453118112242056499895965059288410683055456393608596681927486947146596352*x^17 - 49629745922765358693688137616016992952044121915734358261473661715836704979997403135837651242844160*x^16 - 
    7973049726100243603986458079340357222624401871118637401734648027385920258151651043351788238405632*x^15 - 1190392598094560204694642969724880679240100601750834263791926128601151473319634398842583653548032*x^14 - 
    164332550043011470237420033199826476496806554841603325875937854145967129180762264712056489902080*x^13 - 20861649913104551018593187061357126166499228848639421768797000105115011574716314610306985754624*x^12 - 
    2420571935746374453146607665577696227047405056475294165985266191464368500672425703122845827072*x^11 - 254911250302747512636744376328128131991717258123392714556518255515918909078717915894049144832*x^10 - 
    24164359395181289375876434951089570695147080075191571486639343999180808789334678498143371264*x^9 - 2041515245018372654735115345497038033479318266147553016152953411342375062494228202691493888*x^8 - 
    151839661612389449289393866770929757740456923400304288297777160910220727794237080917245952*x^7 - 9788411587767637436480015217313308229605602208040333637346923020657336043869338874150912*x^6 - 
    535896175242514946143956820596008245487883449788975292482475420653799010342335284248576*x^5 - 24231893508229164923514663704005774097243083118160085998742809452395828149331637043200*x^4 - 
    869103283249818150378853428428669720665774392781894737460199649622415534678375137280*x^3 - 23190819330431252357249765007598563085204945163644215055204998554740587945254715392*x^2 - 409479982562250044393245454176552835526972004813309123770748958048414564152770560*x - 
    3590912124574542046159091120541389027539232930482894606374204698756327824949248;
    
vgl :=  x^17 - 2*x^16 + 12*x^15 - 28*x^14 + 60*x^13 - 160*x^12 + 200*x^11 - 500*x^10 + 705*x^9 - 886*x^8 +
    2024*x^7 - 604*x^6 + 2146*x^5 + 80*x^4 - 1376*x^3 - 496*x^2 - 1013*x - 490;

res_51 := x^51 + 9*x^50 - 2*x^49 - 220*x^48 - 190*x^47 + 4682*x^46 + 20004*x^45 + 22428*x^44 - 61193*x^43 - 
    282413*x^42 - 451586*x^41 + 912472*x^40 + 7338094*x^39 + 11804394*x^38 - 29035800*x^37 - 
    133429396*x^36 - 75027620*x^35 + 467873360*x^34 + 638538712*x^33 - 1334232772*x^32 - 
    866429326*x^31 + 12013960746*x^30 + 11186667600*x^29 - 67400421320*x^28 - 129186820515*x^27 + 
    144122804753*x^26 + 545473249954*x^25 - 72879884696*x^24 - 1138727127664*x^23 + 
    968379931420*x^22 + 3159473169828*x^21 - 6391273298532*x^20 - 16490470125735*x^19 + 
    7227846882637*x^18 + 47684711821118*x^17 + 35948145680208*x^16 - 44246079493990*x^15 - 
    121402066872462*x^14 - 67504580811216*x^13 + 126643250825836*x^12 + 180389142691242*x^11 + 
    3938940842794*x^10 - 112609412982324*x^9 - 109375004979128*x^8 + 6182508790696*x^7 + 
    51133940057848*x^6 + 27915610699760*x^5 - 6954681217168*x^4 - 9184538506732*x^3 + 
    127574298596*x^2 + 637633502248*x - 68258789696 ;
    
p := 641;
[Degree(a[1]) : a in Factorization(g,GF(p))];
[Degree(a[1]) : a in Factorization(res_51,GF(p))];
[Degree(a[1]) : a in Factorization(vgl,GF(p))];

    
nf := NumberField(res_51);
/* time fac := Factorization(g,nf);
[Degree(a[1]) : a in fac]; */
load"fac_120-17t7.txt"; // We load the factorization

kp := GF(641,10);
r_51 := Roots(res_51,kp);
r_51 := [a[1] : a in r_51];
assert #r_51 eq 51;

f_40 := fac[1][1];
co := [Polynomial(Eltseq(a)) : a in Coefficients(f_40)];
r_rel := [Roots(Polynomial([Evaluate(PolynomialRing(kp)!a,r) : a in co])) : r in r_51];
r_rel := [[a[1] : a in b] : b in r_rel];
r_all := SetToSequence(Set(&cat r_rel));
assert #r_all eq 120;

gr := Graph<120 + 51 | {{i,51 + j} : i in [1..51], j in [1..120] | r_all[j] in r_rel[i]}>;

aut := AutomorphismGroup(gr);

#Stabilizer(aut,[1..51]);    
#Stabilizer(aut,[52..120+51]);

// As both stabilizers have group order 1, the splitting fields of res_51 and g are identical.




